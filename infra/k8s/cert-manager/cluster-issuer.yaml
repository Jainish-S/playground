# ClusterIssuer for Let's Encrypt with Contour
# Uses HTTP-01 challenge via Contour's projectcontour.io/ingress class
#
# Why Contour?
# - Type-safe HTTPProxy CRDs (vs nginx annotations)
# - Deep Prometheus metrics (P50/P95/P99 per route)
# - Global rate limiting (free, vs Nginx Plus $$$)
# - xDS hot reload (zero-downtime config updates)
# See docs/CONTOUR_ARCHITECTURE.md for full details

apiVersion: cert-manager.io/v1
kind: ClusterIssuer
metadata:
  name: letsencrypt-staging
spec:
  acme:
    server: https://acme-staging-v02.api.letsencrypt.org/directory
    email: your-email@example.com  # TODO: Update this
    privateKeySecretRef:
      name: letsencrypt-staging-key
    solvers:
      - http01:
          ingress:
            class: contour  # Changed from nginx to contour
---
apiVersion: cert-manager.io/v1
kind: ClusterIssuer
metadata:
  name: letsencrypt-prod
spec:
  acme:
    server: https://acme-v02.api.letsencrypt.org/directory
    email: your-email@example.com  # TODO: Update this
    privateKeySecretRef:
      name: letsencrypt-prod-key
    solvers:
      - http01:
          ingress:
            class: contour  # Changed from nginx to contour
