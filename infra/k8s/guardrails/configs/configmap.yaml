# Guardrails Platform - ConfigMap
apiVersion: v1
kind: ConfigMap
metadata:
  name: guardrail-config
  namespace: guardrails-platform
data:
  # Model service URLs (internal K8s DNS)
  MODEL_PROMPT_GUARD_URL: "http://model-prompt-guard:8000"
  MODEL_PII_DETECT_URL: "http://model-pii-detect:8000"
  MODEL_HATE_DETECT_URL: "http://model-hate-detect:8000"
  MODEL_CONTENT_CLASS_URL: "http://model-content-class:8000"
  
  # Timeouts and circuit breaker
  # Timeout must accommodate: inference (40-60ms) + network + queueing under load
  MODEL_TIMEOUT_SECONDS: "2.0"
  MODEL_CONNECT_TIMEOUT: "0.5"
  # More tolerant thresholds for production stability
  CB_FAILURE_THRESHOLD: "20"
  CB_RECOVERY_TIMEOUT: "10"
  CB_SUCCESS_THRESHOLD: "3"

  # Retry configuration
  RETRY_ENABLED: "true"
  RETRY_MAX_ATTEMPTS: "2"
  RETRY_WAIT_MS: "5"

  # ML inference simulation (enabled to simulate realistic ML latency)
  # Simulates 40-60ms per model call for autoscaling validation
  INFERENCE_DELAY_ENABLED: "true"
  INFERENCE_DELAY_MIN_MS: "40"
  INFERENCE_DELAY_MAX_MS: "60"
