---
title: Deployment Architecture
---
flowchart TB
    subgraph Internet["Internet"]
        Users["ğŸ‘¥ Users"]
    end

    subgraph Edge["Edge Layer"]
        DNS["ğŸŒ DNS<br/>(Cloudflare)"]
        CDN["â˜ï¸ CDN<br/>(Static Assets)"]
    end

    subgraph LB["Load Balancer Layer"]
        Nginx["âš–ï¸ Nginx / Traefik<br/>â€¢ SSL Termination<br/>â€¢ Rate Limiting<br/>â€¢ Request Routing"]
    end

    subgraph Compute["Compute Layer (Docker Swarm / K8s)"]
        subgraph Frontend["Frontend Pods"]
            FE1["ğŸ–¥ï¸ SvelteKit<br/>Node.js"]
            FE2["ğŸ–¥ï¸ SvelteKit<br/>Node.js"]
        end
        
        subgraph API["API Pods (Horizontal Scaling)"]
            API1["ğŸš€ Go API<br/>fasthttp"]
            API2["ğŸš€ Go API<br/>fasthttp"]
            API3["ğŸš€ Go API<br/>fasthttp"]
        end
        
        subgraph Workers["Worker Pods"]
            W1["âš™ï¸ Analytics<br/>Flusher"]
            W2["âš™ï¸ Aggregate<br/>Refresher"]
        end
    end

    subgraph Data["Data Layer"]
        subgraph RedisCluster["Redis (Primary + Replica)"]
            RedisP["ğŸ”´ Redis Primary"]
            RedisR["ğŸ”´ Redis Replica"]
        end
        
        subgraph PGCluster["PostgreSQL + TimescaleDB"]
            PGP["ğŸ˜ Primary<br/>(Read/Write)"]
            PGR["ğŸ˜ Replica<br/>(Read Only)"]
        end
    end

    subgraph Storage["Storage Layer"]
        GeoIP["ğŸ“ GeoIP Database<br/>(Shared Volume)"]
        Backups["ğŸ’¾ Backups<br/>(S3 / GCS)"]
    end

    subgraph Monitoring["Observability"]
        Prometheus["ğŸ“Š Prometheus"]
        Grafana["ğŸ“ˆ Grafana"]
        Logs["ğŸ“ Loki / ELK"]
    end

    %% Connections
    Users --> DNS
    DNS --> CDN
    DNS --> Nginx
    CDN --> Nginx
    
    Nginx --> FE1
    Nginx --> FE2
    Nginx --> API1
    Nginx --> API2
    Nginx --> API3
    
    FE1 & FE2 --> API1 & API2 & API3
    
    API1 & API2 & API3 --> RedisP
    RedisP --> RedisR
    
    API1 & API2 & API3 --> PGP
    API1 & API2 & API3 -.-> PGR
    PGP --> PGR
    
    W1 --> RedisP
    W1 --> PGP
    W2 --> PGP
    
    API1 & API2 & API3 --> GeoIP
    PGP --> Backups
    
    API1 & API2 & API3 --> Prometheus
    W1 & W2 --> Prometheus
    Prometheus --> Grafana
    API1 & API2 & API3 --> Logs

    %% Styling
    style DNS fill:#e3f2fd
    style Nginx fill:#fff9c4
    style API1 fill:#c8e6c9
    style API2 fill:#c8e6c9
    style API3 fill:#c8e6c9
    style RedisP fill:#ffcdd2
    style PGP fill:#ffe0b2
